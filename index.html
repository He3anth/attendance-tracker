<!DOCTYPE html>
<html>
<head>
  <title>Attendance Tracker</title>
</head>
<body>
  <h1>üìÖ Monday - 14/07/2025 Attendance</h1>

  <div id="schedule">
    <!-- Each subject row -->
    <div>
      <strong>8:40‚Äì9:30: Linear Control Systems</strong><br>
      <select id="lcs">
        <option value="">-- Select --</option>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Class Cancelled">Class Cancelled</option>
        <option value="Substitute - DSP">Substitute - DSP</option>
        <option value="Substitute - VLSI">Substitute - VLSI</option>
        <option value="Substitute - AWP">Substitute - AWP</option>
      </select>
    </div>
    <div>
      <strong>9:30‚Äì10:20: Digital Signal Processing</strong><br>
      <select id="dsp">
        <option value="">-- Select --</option>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Class Cancelled">Class Cancelled</option>
        <option value="Substitute - LCS">Substitute - LCS</option>
        <option value="Substitute - VLSI">Substitute - VLSI</option>
        <option value="Substitute - AWP">Substitute - AWP</option>
      </select>
    </div>
    <div>
      <strong>10:20‚Äì11:10: VLSI Design</strong><br>
      <select id="vlsi">
        <option value="">-- Select --</option>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Class Cancelled">Class Cancelled</option>
        <option value="Substitute - DSP">Substitute - DSP</option>
        <option value="Substitute - LCS">Substitute - LCS</option>
        <option value="Substitute - AWP">Substitute - AWP</option>
      </select>
    </div>
    <div>
      <strong>11:10‚Äì12:00: PE-1 Antennas & Wave Propagation</strong><br>
      <select id="awp">
        <option value="">-- Select --</option>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Class Cancelled">Class Cancelled</option>
        <option value="Substitute - DSP">Substitute - DSP</option>
        <option value="Substitute - VLSI">Substitute - VLSI</option>
        <option value="Substitute - LCS">Substitute - LCS</option>
      </select>
    </div>
    <div>
      <strong>12:00‚Äì12:50: Lunch Break</strong><br>
      <select disabled>
        <option value="">Break Time üç±</option>
      </select>
    </div>
    <div>
      <strong>12:50‚Äì3:20: SOC Microwave Circuits & Antenna Design Lab</strong><br>
      <select id="soclab">
        <option value="">-- Select --</option>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Class Cancelled">Class Cancelled</option>
        <option value="Substitute - DSP">Substitute - DSP</option>
        <option value="Substitute - VLSI">Substitute - VLSI</option>
        <option value="Substitute - LCS">Substitute - LCS</option>
      </select>
    </div>
  </div>

  <br>
  <button onclick="submitAttendance()">‚úÖ Submit Attendance</button>

  <script>
    function sendAttendanceToSheet(subject, date, status) {
      const url = "https://script.google.com/macros/s/AKfycbxbVKjWTAy038lF_j6498L5T8N-U2M3JPOfwOwh1GyiMGKP6Z_SBpNSK616hDCpkHQHzA/exec";

      fetch(url, {
        method: "POST",
        body: JSON.stringify({
          subject: subject,
          date: date,
          status: status
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(res => res.text())
      .then(data => console.log(data))
      .catch(err => console.error("Error:", err));
    }

    function submitAttendance() {
      const date = "14-07-2025";

      const subjects = {
        "Linear Control Systems": document.getElementById("lcs").value,
        "Digital Signal Processing": document.getElementById("dsp").value,
        "VLSI Design": document.getElementById("vlsi").value,
        "Antennas & Wave Propagation": document.getElementById("awp").value,
        "SOC Microwave Lab": document.getElementById("soclab").value
      };

      for (const [subject, status] of Object.entries(subjects)) {
        if (status !== "") {
          sendAttendanceToSheet(subject, date, status);
        }
      }

      alert("‚úÖ Attendance submitted!");
    }
  </script>
</body>
</html>

